<div ng-init="init()">
    <div class="content col-md-8 col-sm-12 col-xs-12">
        <div class="section-block">
            <div class="page-header">
                <div class="row">
                    <div class="col-lg-12 text-center">
                        <h1>
                            <bold>LIGA: {{league.name}}</bold>
                        </h1>
                    </div>
                    <div class="col-lg-9 text-left text-left">
                        <h4>
                            <bold>LISTA KOLEJEK</bold>
                        </h4>
                    </div>

                    <div class="col-lg-3 text-right">
                        <button type="button" class="btn btn-primary btn-lg" ng-click="setNewMatchSettings(round)" data-toggle="modal" data-target="#roundModal" title="DODAJ KOLEJKĘ"><span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span></button>
                    </div>
                </div>
            </div>
            <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="false">
                <div class="panel panel-default" ng-repeat="round in rounds">
                    <div class="panel-heading" style="background-color: darkcyan; font-weight:bold;" role="tab" id="headingOne{{round.roundId}}" is-open="$first" is-open="$first">
                        <div class="row">
                            <div class="panel-title" data-toggle="collapse" data-target="#collapseOne{{round.roundId}}" aria-expanded="false" data-parent="#accordion">
                                <div class="col-xs-4 text-left">
                                    <label style="color:whitesmoke">
                            {{round.whichLeagueRound}} KOLEJKA
                        </label>
                                </div>
                                <div class="col-xs-4 text-center">
                                    <label style="color:whitesmoke">{{claculateTime(round.roundDate) | date: 'dd MMMM yyyy'}}</label>
                                </div>
                            </div>
                            <div class="col-xs-4 text-right">
                                <button type="button" ng-click="setNewMatchSettings(round)" data-toggle="modal" data-target="#matchModal" class="btn btn-success" aria-label="Left Align">
                    <span class="glyphicon glyphicon-plus" data-toggle="tooltip" data-placement="top" title="Dodaj mecz" aria-hidden="true"></span></button>
                                <button type="button" class="btn btn-danger btn-xs" data-toggle="modal" data-target="#deleteRoundModal" title="Usuń kolejkę" ng-click="setEditRoundContext(round)">
                        <span class="glyphicon glyphicon-remove-sign" aria-hidden="true"></span></button>

                            </div>
                        </div>
                    </div>
                    <div id="collapseOne{{round.roundId}}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne{{round.roundId}}">
                        <div class="panel-body ">
                            <!-- LISTA MECZÓW -->
                            <!--<table class="table" ng-repeat="match in leagueMatches | filter : {roundId: round.roundId}">-->
                            <div class="container-fluid">
                                <div class="row" ng-repeat="match in leagueMatches | filter : {roundId: round.roundId}">
                                    <div class="row" style="background-color:aliceblue;">
                                        <div class="col-xs-1 text-center hidden-xs" style="padding:16px;"><label class="label label-default">{{claculateTime(match.matchDate) | date: 'HH:mm'}}</label></div>
                                        <div class="col-xs-1 text-right" style="padding-top:8px;">
                                            <div data-toggle="tooltip" style="background-color:darkcyan; height:35px; width:35px; border-radius:5px;
                                                                " data-placement="top" ng-attr-title="{{match.homeTeamName}}">
                                                <img ng-src="{{match.homeTeamLogoUrl}}" width="35px" height="35px" data-toggle="tooltip" data-placement="top" title="{{match.homeTeamName}}">
                                            </div>

                                        </div>
                                        <div class="col-xs-3 text-right" style="padding-top:5px;">
                                            <div style="color: black;">
                                                <div class="row"><label style="text-transform: uppercase;">{{match.homeFirstPlayerAlias}}</label></div>
                                                <div class="row"><label style="text-transform: uppercase;">{{match.homeSecondPlayerAlias}}</label></div>
                                            </div>

                                        </div>

                                        <div class="col-xs-2 text-center" style=" width:100px; padding-top:10px;">

                                            <button type="button" style="width:100%; font-size:20px;" class="btn btn-success btn-xs" data-toggle="modal" data-target="#myModal" ng-click="setEditContext(match)" data-placement="top" title="Edytuj wynik">{{match.homeGoals}}:{{match.awayGoals}}</button>

                                        </div>

                                        <div class="col-xs-3 text-left" style="padding-top:5px;">
                                            <div style="color: black;">
                                                <div class="row"><label style="text-transform: uppercase;">{{match.awayFirstPlayerAlias}}</label></div>
                                                <div class="row"><label style="text-transform: uppercase;">{{match.awaySecondPlayerAlias}}</label></div>
                                            </div>

                                        </div>
                                        <div class="col-xs-1 text-left" style="padding-top:8px;">
                                            <div data-toggle="tooltip" style="background-color:darkcyan; height:35px; width:35px; border-radius:5px;
                                                                " data-placement="top" ng-attr-title="{{match.awayTeamName}}">
                                                <img ng-src="{{match.awayTeamLogoUrl}}" width="35px" height="35px" data-toggle="tooltip" data-placement="top" title="{{match.awayTeamName}}">
                                            </div>

                                        </div>
                                        <div class="col-xs-1 text-right" style="padding-top:4px;">
                                            <div class="hidden-xs">
                                                <div class="row"><button type="button" class="btn btn-default btn-xs">
                              <span class="glyphicon glyphicon-edit glyphicon-align-left" aria-hidden="true"></span></button></div>
                                                <div class="row"><button type="button" class="btn btn-danger btn-xs" data-toggle="modal" data-target="#deleteMatchModal" title="Usuń mecz" ng-click="setEditContext(match)">
                              <span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button></div>
                                            </div>

                                        </div>
                                        <div class="col-xs-12" style="background-color:darkcyan; height:3px;width:100%"></div>
                                        <div class="col-xs-12" style="background-color:gray; height:2px;width:100%"></div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MODALNE OKNO EDYCJI WYNIKU -->
            <div class="modal fade" id="myModal" role="dialog">
                <div class="modal-dialog">

                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">{{claculateTime(matchEdited.matchDate) | date: 'EEEE, MMMM M, yyyy - HH:mm'}} </h4>
                        </div>
                        <table class="table table-striped table-dark">
                            <tbody>
                                <tr class="matchRow">
                                    <td style="text-align:center">
                                        <div data-toggle="tooltip" style="background-color:gray; height:40px; width:40px; border-radius:10px;
                                " data-placement="top" ng-attr-title="{{matchEdited.homeTeamName}}">
                                            <img ng-src="{{matchEdited.homeTeamLogoUrl}}" width="40px" height="40px" data-toggle="tooltip" data-placement="top" title="{{matchEdited.homeTeamName}}">
                                        </div>
                                    </td>
                                    <td style="text-align:center">
                                        <div style="color: black;">
                                            <div class="row"><label>{{matchEdited.homeFirstPlayerAlias}}</label></div>
                                            <div class="row"><label>{{matchEdited.homeSecondPlayerAlias}}</label></div>
                                        </div>
                                    </td>
                                    <td style="text-align:center">
                                        <td>
                                            <input type="text" style="width:50px; font-size:20px; text-align:center; font-weight:bold" class="form-control col-sm-1" ng-model="matchEdited.homeGoals" id="homeGoals">

                                        </td>
                                        <td>
                                            <input type="text" style="width:50px; font-size:20px; text-align:center; font-weight:bold" class="form-control col-sm-1" ng-model="matchEdited.awayGoals" id="awayGoals">
                                        </td>
                                    </td>
                                    <td style="text-align:center">
                                        <div style="color: black;">
                                            <div class="row"><label>{{matchEdited.awayFirstPlayerAlias}}</label></div>
                                            <div class="row"><label>{{matchEdited.awaySecondPlayerAlias}}</label></div>
                                        </div>
                                    </td>
                                    <td style="text-align:center">
                                        <div data-toggle="tooltip" style="background-color:gray; height:40px; width:40px; border-radius:10px;
                                " data-placement="top" ng-attr-title="{{matchEdited.awayTeamName}}">
                                            <img ng-src="{{matchEdited.awayTeamLogoUrl}}" width="40px" height="40px" data-toggle="tooltip" data-placement="top" title="{{matchEdited.awayTeamName}}">
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-success" ng-click="editMatch()" data-dismiss="modal">EDYTUJ</button>
                        </div>
                    </div>

                </div>
            </div>


            <!-- MODAL - DODAWANIE MECZU -->
            <div class="modal fade" id="matchModal" tabindex="-1" role="dialog" aria-labelledby="matchModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="matchModalLabel">DODAJ MECZ</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
                        </div>

                        <div class="modal-body">

                            <!-- Create Match form -->
                            <form name="newMatchForm" novalidate>
                                <div class=form-row>
                                    <div class="form-group col-md-6 text-center" ng-class="{'has-error': newMatchForm.homeData.$invalid}">
                                        <label for="homeData">GOSPODARZE</label>
                                        <div class="well">
                                            <div class="form-group">
                                                <select class="selectpicker form-control" id="homeFirstPlayer" name="homeFirstPlayer" data-live-search="true" ng-model="newMatch.homeFirstPlayerId" ng-options="player.playerId as player.alias for player in players">
                                            <option value="" disabled>--Wybierz gracza--</option>
                                                    </select>
                                                <small class="error" ng-show="newMatchForm.homeFirstPlayer.$error.required">Gracze są wymagani</small>
                                            </div>
                                            <div class="form-group">
                                                <select class="selectpicker form-control" id="homeSecondPlayer" name="homeSecondPlayer" data-live-search="true" ng-model="newMatch.homeSecondPlayerId" ng-options="player.playerId as player.alias for player in players">
                                            <option value="" disabled>--Wybierz gracza--</option>
                                        </select>
                                                <small class="error" ng-show="newMatchForm.homeSecondPlayer.$error.required">Gracze są wymagani</small>
                                            </div>
                                            <div class="form-group">
                                                <select class="selectpicker form-control" id="homeTeam" name="homeTeam" data-live-search="true" data-live-search="true" ng-model="newMatch.homeTeamId" ng-options="team.teamId as team.name for team in teams ">
                                            <option value="" disabled>--Wybierz drużynę--</option>
                                        </select>
                                                <small class="error" ng-show="newMatchForm.homeTeam.$error.required">Drużyny są wymagane</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group col-md-6 text-center">
                                        <label for="awayData">GOŚCIE</label>
                                        <div class="well">
                                            <div class="form-group" ng-class="{'has-error': newMatchForm.awayFirstPlayer.$invalid}">
                                                <select class="selectpicker form-control" id="awayFirstPlayer" name="awayFirstPlayer" data-live-search="true" ng-model="newMatch.awayFirstPlayerId" ng-options="player.playerId as player.alias for player in players">
                                            <option value="" disabled>--Wybierz gracza--</option>
                                        </select>
                                                <small class="error" ng-show="newMatchForm.awayFirstPlayer.$error.required">Gracze są wymagani</small>
                                            </div>

                                            <div class="form-group" ng-class="{'has-error': newMatchForm.awaySecondPlayer.$invalid}">
                                                <select class="selectpicker form-control" id="awaySecondPlayer" name="awaySecondPlayer" data-live-search="true" ng-model="newMatch.awaySecondPlayerId" ng-options="player.playerId as player.alias for player in players">
                                            <option value="" disabled>--Wybierz gracza--</option>
                                        </select>
                                                <small class="error" ng-show="newMatchForm.awaySecondPlayer.$error.required">Gracze są wymagani</small>
                                            </div>

                                            <div class="form-group" ng-class="{'has-error': newMatchForm.awayTeam.$invalid}">
                                                <select class="selectpicker form-control" id="awayTeam" name="awayTeam" data-live-search="true" ng-model="newMatch.awayTeamId" ng-options="team.teamId as team.name for team in teams">
                                            <option value="" disabled>--Wybierz drużynę--</option>
                                                </select>
                                                <small class="error" ng-show="newMatchForm.awayTeam.$error.required">Gracze są wymagani</small>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group col-md-12">
                                        <label for="comment" class="col-form-label">Komentarz meczowy</label>
                                        <textarea class="form-control" ng-model="newMatch.comments" id="comment" placeholder="Dodaj komentarz"></textarea>
                                    </div>
                                </div>
                                <div class="form-group text-right">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Zamknij</button>
                                    <button type="reset" class="btn btn-info" id="match-reset-btn" ng-click="resetNewMatch()">Wyczyść</button>
                                    <button type="submit" class="btn btn-primary" ng-click="addNewMatch(newMatch.homeFirstPlayerId,newMatch.homeSecondPlayerId,newMatch.awayFirstPlayerId,newMatch.awaySecondPlayerId,newMatch.homeTeamId,newMatch.awayTeamId,newMatch.comments,activeRound.roundId,activeRound.leagueId)"
                                        data-dismiss="modal" ng-disabled="newMatchForm.$invalid">Dodaj mecz</button>
                                </div>
                            </form>

                        </div>
                        <div class="modal-footer">

                        </div>
                    </div>
                </div>
            </div>


            <!-- modal usuwanie meczu -->
            <!-- Modal -->
            <div class="modal fade" id="deleteMatchModal" tabindex="-1" role="dialog" aria-labelledby="deleteMatchModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="deleteMatchModalLabel">
                                <bold>Usuwanie meczu</bold>
                            </h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
                        </div>
                        <div class="modal-body">
                            Czy na pewno chcesz usunąć mecz?
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Anuluj</button>
                            <button type="button" class="btn btn-danger" data-dismiss="modal" ng-click="deleteMatch(matchEdited.matchId)">USUŃ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- modal usuwanie kolejki -->
            <!-- Modal -->
            <div class="modal fade" id="deleteRoundModal" tabindex="-1" role="dialog" aria-labelledby="deleteRoundModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="deleteRoundModalLabel">
                                <bold>Usuwanie kolejki</bold>
                            </h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
                        </div>
                        <div class="modal-body">
                            Czy na pewno chcesz usunąć kolejkę {{roundEdited.whichLeagueRound}}?
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Anuluj</button>
                            <button type="button" class="btn btn-danger" data-dismiss="modal" ng-click="deleteRound(roundEdited.roundId)">USUŃ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- OKNO MODALNE TWORZENIA KOLEJKI -->
            <div class="modal fade" id="roundModal" tabindex="-1" role="dialog" aria-labelledby="roundModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="roundModalLabel">
                                <bold>Utwórz kolejkę</bold>
                            </h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
                        </div>

                        <div class="modal-body">

                            <!-- Create league form -->
                            <form novalidate name="roundForm">
                                <div class=form-row>
                                    <div class="form-group col-md-12" ng-class="{'has-error': roundForm.description.$invalid}">
                                        <label for="description" class="col-form-label"><bold>Opis kolejki</bold></label>
                                        <textarea class="form-control" ng-model="newRound.description" name="description" ng-maxlength="25" required id="description" placeholder="Opis kolejki"></textarea>
                                        <small class="error" ng-show="roundForm.description.$error.required">Opis kolejki jest wymagany</small>
                                        <small class="error" ng-show="roundForm.description.maxlength">Zbyt długi opis</small>
                                    </div>
                                </div>
                                <div class="form-group text-right">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Anuluj</button>
                                    <button type="submit" class="btn btn-primary" ng-click="addRound(quantityOfRounds, leagueId, newRound.description)" data-dismiss="modal" ng-disabled="roundForm.$invalid">Zapisz</button>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="content col-md-4 col-sm-12 col-xs-12">
        <div class="section-block summary">
            <div class="row">
                <div class="col-xs-6 text-left">
                    <label class="label label-default">TABELA LIGOWA</label>
                </div>
                <div class="col-xs-6 text-right">
                    <button type="button" class="btn btn-default btn-xs" title="Pokaż pełną tabelę">
                    <span class="glyphicon glyphicon-fullscreen" aria-hidden="true"></span>
                  </button>
                </div>
            </div>
            <div class="row">
                <table class="table table-sm" style="color:whitesmoke">
                    <thead>
                        <tr style="font-weight: bold;">
                            <th scope="col">#</th>
                            <th scope="col"><span class="glyphicon glyphicon-user" aria-hidden="true"></span></th>
                            <th class="align-middle" scope="col">M</th>
                            <th class="align-middle" scope="col">Z</th>
                            <th class="align-middle" scope="col">R</th>
                            <th class="align-middle" scope="col">P</th>
                            <th class="align-middle" scope="colgroup" colspan="3">+ / -</th>
                            <th class="align-middle" scope="col">WspPkt</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="table in leagueTable">
                            <td scope="row">{{ $index + 1 }}</td>
                            <td scope="col">{{table.alias}}</td>
                            <td class="align-middle" scope="col">{{table.matches}}</td>
                            <td class="align-middle" scope="col">{{table.wins}}</td>
                            <td class="align-middle" scope="col">{{table.draws}}</td>
                            <td class="align-middle" scope="col">{{table.loses}}</td>
                            <td class="text-right" scope="col">{{table.goalsScored}}</td>
                            <td class="text-center">-</td>
                            <td class="text-left" scope="col">{{table.goalsConceded}}</td>
                            <td class="align-middle" scope="col">{{table.pointsRate}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>